import vulners
import requests
import json
from bs4 import BeautifulSoup

class VulnGatherer():


    def vulners():
        vulners_api = vulners.Vulners(api_key="B79F7OLOWDCJR7GG1WN96Z0ZY6K2S96B0HBT9MP9KYZ1JSGZBZEC9NDHUN98LQHT")

        heartbleed_related = vulners_api.search(input(), limit=10)

        #print(heartbleed_related)
        for items in heartbleed_related:
            print(items.keys())
            print(items[input()])


    def CVE_org(self, search_term):
        getpage = requests.get("https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=" + search_term)
        getpage_soup = BeautifulSoup(getpage.text, 'html.parser')

        info = getpage_soup.find("div",{"id":"TableWithRules"})
        page_list = []
        for i in info.findAll("td"):
            #print(i.text)
            page_list.append(i.text)
        y = 0
        cve_list = []
        description_list = []

        for i in page_list[:2]:
            cve_list.append(page_list[y])#All even number are the CVE numbers

            y += 1
            description_list.append(page_list[y])# The Odd number are the descibtions of the previous CVE number
            y += 1

        return cve_list, description_list
            # print("/n")
        # for vulns in cve_list[:1]:
        #     print(vulns)
        #     print(description_list)
        #     print("\n")


two_lists = VulnGatherer().CVE_org("API")
list1 = two_lists[0]
list2 = two_lists[1]
print(list1[0])
print(list2[0])
