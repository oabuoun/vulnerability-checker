
<html>
<head>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>User Dashboard</title>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
	<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
	<link rel="stylesheet" type = "text/css" href="{{ url_for('static', filename = 'css/user_dashboardCSS.css') }}" title = "home page CSS"/>

	<script  src="https://code.jquery.com/jquery-3.3.1.min.js"   integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="   crossorigin="anonymous"></script>

	<script type="text/javascript">
	    var myToken = localStorage.getItem("myToken")
	    var myUsername = localStorage.getItem("myUsername")

	    if ((myToken == null) || (myToken == "")) {
	      document.location.href = "/"
	    }

	    function logout(){
	      localStorage.removeItem("myToken")
	      localStorage.removeItem("myUsername")
	      document.location.href = "/"
	    }

	</script>
	<script>
	//james' javascript
	function scrollToTop() {
	  document.body.scrollTop = 0; // For Safari
	  document.documentElement.scrollTop = 0; // For Chrome, Firefox, IE and Opera
	}
	</script>
</head>
<body>

<div class="header">
	<div class = "topheader">
		<a><img src = "/static/perm_images/logo.jpg" alt = "Logo, Avatar, Character"/></a>
	</div>
	<div class="topnav" id="myTopnav">
		<div class="topnav-right">
			<a href="javascript:void(0);" class="icon" onclick="navShrink()">
			<i class="menu-bars"></i>
			</a>
		</div>
	</div>
</div>

<div class="rowShape">
	<div class="col-d-11 col-t-12">
		<h2>User Dashboard</h2>
	</div>
	<div class="col-d-3 col-t-12">
	</div>




			</div>
		</div>
	</div>
	<a href='#' class="notification">
		<span>Notifications</span>
		<span class="badge"</span>
	</a>





	<div class="col-d-4 col-t-12">
		<h3>New project</h3>
		<div class="project_container">
			<form action = "/new_project" method = "post">
			<div class="form-group">

				<input type="text" class="form-control" id = "project_name" placeholder="Enter Project Name" name="project_name" value= "{{project_name}}" required>

				<input type="text"  class="form-control" id = "component" placeholder="Enter Component Name" name="component"value="{{component}}" required>
				<input type="text"  class="form-control" id = "component" placeholder="Enter Component Type" name="component"value="{{component}}" required>
				<input type="text"  class="form-control" id = "version" placeholder="Enter Version of Component" name="version" value= "{{version}}" required>
				<input type="submit" value="Submit">
				<input type="reset" value="Reset">
			</div>
			</form>

		</div>
	</div>
</div>



		  <div class="col-d-3 col-t-12">
				<h3>My Projects</h3>
		    <form id="opForm">
					<input type="text"  class="form-control" id = project placeholder="Enter Project Name" name="project" required />
		  		<input id = "button_submit" type="submit" value="Project Vulnerabilities"/>
		  		<div id="showData"></div>
		    </form>
			</div>
		    <script type="application/javascript">

		      $("#opForm").submit(function (e){

		        var action = "/user_dashboard/vulnerabilities?page=" + page
		        $.ajax({
		          type: "GET",
		          url: action,
		          processData: false,
		          dataType: 'json',
		          async: false,
		          headers: {
		            "Authorization": "Bearer " + myToken
		          },
		          data: $("#opForm").serialize(),

		          success: function (response) {

		            // EXTRACT VALUE FOR HTML HEADER.
		            // ('Book ID', 'Book Name', 'Category' and 'Price')
		            var col = [];
		            for (var i = 0; i < response.length; i++) {
		                for (var key in response[i]) {

		                    if (col.indexOf(key) === -1) {
		                        col.push(key);
		                    }
		                }
		            }

		            // CREATE DYNAMIC TABLE.
		            var table = document.createElement("table");

		            // CREATE HTML TABLE HEADER ROW USING THE EXTRACTED HEADERS ABOVE.

		            var tr = table.insertRow(-1);                   // TABLE ROW.

		            for (var i = 0; i < col.length; i++) {
		                var th = document.createElement("th");      // TABLE HEADER.
		                th.innerHTML = col[i];
		                tr.appendChild(th);
		            }

								for (var i = 0; i < response.length; i++) {
		            	tr = table.insertRow(-1);

									for (var j = 0; j < col.length; j++) {
						      	var tabCell = tr.insertCell(-1);
						        tabCell.innerHTML = response[i][col[j]];
						      }
						    }

								//alert(table)
		            var divContainer = document.getElementById("showData");
								//alert(divContainer)
		            divContainer.innerHTML = "";
		            divContainer.appendChild(table);
		            //$("#showData").html("")
								//$("#showData").append(table)
		        },
		          error: function (error) {
		            alert(JSON.stringify(error))
		          },
		          complete: function () {
		            // Handle the complete event
		          }
		        });
		        e.preventDefault() ;
		      }) ;
		    </script>



			<div class="col-d-3 col-t-12">
				<form id="projectForm">
					<input id = "button_submit" type="submit" value="My Projects"/>
					<div id="showData"></div>
				</form>
			</div>
				<script type="application/javascript">

					$("#opForm").submit(function (e){

						var action = "/user_dashboard/projects?page=" + page
						$.ajax({
							type: "GET",
							url: action,
							processData: false,
							dataType: 'json',
							async: false,
							headers: {
								"Authorization": "Bearer " + myToken
							},
							data: $("#opForm").serialize(),

							success: function (response) {

								// EXTRACT VALUE FOR HTML HEADER.
								// ('Book ID', 'Book Name', 'Category' and 'Price')
								var col = [];
								for (var i = 0; i < response.length; i++) {
										for (var key in response[i]) {

												if (col.indexOf(key) === -1) {
														col.push(key);
												}
										}
								}

								// CREATE DYNAMIC TABLE.
								var table = document.createElement("table");

								// CREATE HTML TABLE HEADER ROW USING THE EXTRACTED HEADERS ABOVE.

								var tr = table.insertRow(-1);                   // TABLE ROW.

								for (var i = 0; i < col.length; i++) {
										var th = document.createElement("th");      // TABLE HEADER.
										th.innerHTML = col[i];
										tr.appendChild(th);
								}

								for (var i = 0; i < response.length; i++) {
									tr = table.insertRow(-1);

									for (var j = 0; j < col.length; j++) {
										var tabCell = tr.insertCell(-1);
										tabCell.innerHTML = response[i][col[j]];
									}
								}

								//alert(table)
								var divContainer = document.getElementById("showData");
								//alert(divContainer)
								divContainer.innerHTML = "";
								divContainer.appendChild(table);
								//$("#showData").html("")
								//$("#showData").append(table)
						},
							error: function (error) {
								alert(JSON.stringify(error))
							},
							complete: function () {
								// Handle the complete event
							}
						});
						e.preventDefault() ;
					}) ;
				</script>

			<div class="col-d-2 col-t-12">
				<div class="user_container">
						<button id= "btnLogout" type="button" value="Log Out" onclick="logout()">Log out</button>
					<div class="form-group">

					</div>
				</div>
</body>
